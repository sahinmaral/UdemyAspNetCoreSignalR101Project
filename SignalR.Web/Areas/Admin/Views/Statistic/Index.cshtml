@{
    ViewBag.Title = "İstatistik";
    Layout = "_AdminLayout";
}

<style>
	.card .card-body.center{
		justify-content: center;
		align-items: center;
		display: flex;
		height: 120px;
	}
	
</style>

<div class="content">
<div class="container-fluid">
<h4 class="page-title">Anlık İstatistik Sayfası</h4>
<div class="row">
	<div class="col-md-3">
		<div class="card card-stats card-warning">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-list"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Kategori Sayısı</p>
							<h4 class="card-title" id="categoryCount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-success">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="la la-shopping-cart"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Ürün Sayısı</p>
							<h4 class="card-title" id="productCount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-danger">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="la la-newspaper-o"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Aktif Kategori Sayısı</p>
							<h4 class="card-title" id="activeCategoryCount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-primary">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="la la-check-circle"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Pasif Kategori Sayısı</p>
							<h4 class="card-title" id="passiveCategoryCount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-md-3">
		<div class="card card-stats card-warning">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-burger"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Hamburger kategorisine ait ürün sayısı</p>
							<h4 class="card-title" id="productCountWithHamburgerCategory"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-success">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-glass-water"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">İçecek kategorisine ait ürün sayısı</p>
							<h4 class="card-title" id="productCountWithIcecekCategory"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-danger">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-line-chart"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Ürünlerin ortalama fiyatı</p>
							<h4 class="card-title" id="productsAveragePrice"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-primary">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-arrow-up"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">En yüksek fiyatlı ürün adı</p>
							<h4 class="card-title" id="maximumPriceProductName"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-md-3">
		<div class="card card-stats card-warning">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-arrow-down"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">En düşük fiyatlı ürün adı</p>
							<h4 class="card-title" id="minimumPriceProductName"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-success">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-burger"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Ortalama Hamburger fiyatı</p>
							<h4 class="card-title" id="averagePriceWithHamburgerCategory"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-danger">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-store"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Toplam sipariş sayısı</p>
							<h4 class="card-title" id="orderCount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-primary">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-store"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Aktif sipariş sayısı</p>
							<h4 class="card-title" id="activeOrderCount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-md-3">
		<div class="card card-stats card-warning">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-chair"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Toplam masa sayısı</p>
							<h4 class="card-title" id="totalRestaurantTableCount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-success">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-money-bill"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Son sipariş toplam fiyat</p>
							<h4 class="card-title" id="lastOrderTotalPrice"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-danger">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-money-bill-trend-up"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Bugünkü kazanç</p>
							<h4 class="card-title" id="todayEarning"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card card-stats card-primary">
			<div class="card-body center">
				<div class="row">
					<div class="col-5">
						<div class="icon-big text-center">
							<i class="fas fa-cash-register"></i>
						</div>
					</div>
					<div class="col-7 d-flex align-items-center">
						<div class="numbers">
							<p class="card-category">Kasadaki toplam tutar</p>
							<h4 class="card-title" id="totalCashRegisterAmount"></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
</div>
</div>

@section Scripts
{
    <script src="~/microsoft/signalr/dist/browser/signalr.min.js"></script>

    <script type="text/javascript">
        $(document).ready(async() => {
            var connection = new signalR.HubConnectionBuilder().withUrl("http://localhost:5229/signalrhub").build();
            $("#connStatus").text(connection.state);
            connection.start().then(() => {
                $("#connStatus").text(connection.state);
                setInterval(() => {
                    connection.invoke("SendStatistic");
                }, 1000);
               
            }).catch((err) => { console.log(err) });

			connection.on("ReceiveCategoryCountDetailed", (value) => {
				$("#categoryCount").text(value.all);
				$("#activeCategoryCount").text(value.active);
				$("#passiveCategoryCount").text(value.passive);
			});
			
			connection.on("ReceiveProductCount", (value) => {
                $("#productCount").text(value);
            });
			
			connection.on("ReceiveCountProductWithHamburgerCategory", (value) => {
                $("#productCountWithHamburgerCategory").text(value);
            });
			
			connection.on("ReceiveCountProductWithIcecekCategory", (value) => {
                $("#productCountWithIcecekCategory").text(value);
            });	
			
			connection.on("ReceiveProductsAveragePrice", (value) => {
                $("#productsAveragePrice").text(value);
            });	
			
			connection.on("ReceiveMinimumPriceProductName", (value) => {
				$("#minimumPriceProductName").text(value);
			});	
			
			connection.on("ReceiveMaximumPriceProductName", (value) => {
				$("#maximumPriceProductName").text(value);
			});			

			connection.on("ReceiveAveragePriceWithHamburgerCategory", (value) => {
				$("#averagePriceWithHamburgerCategory").text(value);
			});		
				
			connection.on("ReceiveOrderCountDetailed", (value) => {				
					$("#orderCount").text(value.all);
					$("#activeOrderCount").text(value.active);
			});
			
			connection.on("ReceiveLastOrderTotalPrice", (value) => {
				$("#lastOrderTotalPrice").text(value);
			});
			
			connection.on("ReceiveTodayEarning", (value) => {
				$("#todayEarning").text(value);
			});
			
			connection.on("ReceiveTotalCashRegisterAmount", (value) => {
				$("#totalCashRegisterAmount").text(value);
			});				
			
			connection.on("ReceiveTotalRestaurantTableCount", (value) => {
				$("#totalRestaurantTableCount").text(value);
			});			
			
        });
    </script>
}
